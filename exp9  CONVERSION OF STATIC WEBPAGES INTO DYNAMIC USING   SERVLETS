PROCEDURE:  
Step 1: We will create ahtml form for entering the user name,password and card ID.  
Step 2:  From the above HTML  form, the servlet program is invoked in which the validity of the    
           user name,password and card id is checked.if it is a valid user then the welcome message   
           will be displayed otherwise the “invalid user” message will be displayed. In this servlet we   
           set the cookies in which the current user name is stored.   
Step 3: Compile the above servlet Login servlet.java and copy its class file in tomcats folder at  
             c:\tomcatdirectory\webapps\examples\WEB-INF\classes.  
Step 4: Then edit the web.xml in WEB-INF folder.We must store he user information such as  
             user  
             name,password and card id in the web.xml using init-param.   
Step 5: On successful login , the information from the cookie is checked and shopping cart page  
            for corressponding user can be displayed.  
Step 6: Compile the above servlet LoginSuccess.java and copy its class file in the tomcat's folder  
            at c:\tomcatdirectory\webapps\examples\WEB-INF\classes.  
Step 7: Then edit the web.xml in  WEB-INF  folder.  
Step 8: Start tomcat web server. Open the web browser and display the login form created in  
            step1. 



Loginform.html
<!DOCTYPE html>
<html>
<head>
    <title>Login Form</title>
</head>
<body>
    <form action="http://localhost:8080/shopping/LoginServlet" method="post">
        Enter username:
        <input type="text" name="User"><br><br>

        Enter password:
        <input type="password" name="password"><br><br>

        Enter card ID:
        <input type="text" name="CardID"><br><br>

        <input type="submit" value="login">
    </form>
</body>
</html>

LoginServlet.java
package shopping;

import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class LoginServlet extends HttpServlet {

    protected void doPost(HttpServletRequest req, HttpServletResponse res)
            throws ServletException, IOException {

        res.setContentType("text/html");
        PrintWriter out = res.getWriter();

        String usr = req.getParameter("User");
        String pwd = req.getParameter("password");
        String card = req.getParameter("CardID");

        boolean flag = true;

        String[] userID = getInitParameter("usernames").trim().split(",");
        String[] passwords = getInitParameter("passwords").trim().split(",");
        String[] cardids = getInitParameter("cardIDs").trim().split(",");

        for (int i = 0; i < userID.length; i++) {

            if (userID[i].trim().equals(usr) &&
                passwords[i].trim().equals(pwd) &&
                cardids[i].trim().equals(card)) {

                flag = false;

                Cookie cookie1 = new Cookie("CurrentUser", usr);
                Cookie cookie2 = new Cookie("CreditCard", card);

                res.addCookie(cookie1);
                res.addCookie(cookie2);

                out.println("<h2>Welcome " + usr + "</h2><hr>");
                out.println("<h2>Select the book you would like to purchase</h2><hr>");

                out.println("<form action='LoginSuccess'>");
                out.println("<input type='radio' name='book' value='Let Us C' checked> Let Us C<br>");
                out.println("<input type='radio' name='book' value='Exploring Python'> Exploring Python<br>");
                out.println("<input type='radio' name='book' value='Mastering C'> Mastering C<br><br>");
                out.println("<input type='submit' value='Purchase'>");
                out.println("</form>");

                return;
            }
        }

        // Invalid login
        if (flag) {
            out.println("<h4>Invalid username or password or card number.</h4>");
            out.println("<a href='LoginForm.html'>Try Again</a>");
        }

        out.close();
    }
}

LoginSuccess.java
package shopping;

import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;

public class LoginSuccess extends HttpServlet {

    protected void doGet(HttpServletRequest req, HttpServletResponse res)
            throws ServletException, IOException {

        res.setContentType("text/html");
        PrintWriter out = res.getWriter();

        Cookie[] cookies = req.getCookies();
        String user = "";
        String card = "";

        if (cookies != null) {
            for (Cookie c : cookies) {
                if (c.getName().equals("CurrentUser"))
                    user = c.getValue();
                if (c.getName().equals("CreditCard"))
                    card = c.getValue();
            }
        }

        String book = req.getParameter("book");

        out.println("<h2>Welcome " + user + "</h2><hr>");
        out.println("<h3>Thank you for purchasing: " + book + "</h3><hr>");
        out.println("<h3>Rs. 250 debited from credit card: " + card + "</h3>");

        out.close();
    }
}


web.xml
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.1"
         xmlns="http://xmlns.jcp.org/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee
         http://xmlns.jcp.org/xml/ns/javaee/webapp_3_1.xsd">

    <servlet>
        <servlet-name>LoginServlet</servlet-name>
        <servlet-class>shopping.LoginServlet</servlet-class>

        <init-param>
            <param-name>usernames</param-name>
            <param-value>indhu,abc,xyz</param-value>
        </init-param>

        <init-param>
            <param-name>passwords</param-name>
            <param-value>indhu,abc,xyz</param-value>
        </init-param>

        <init-param>
            <param-name>cardIDs</param-name>
            <param-value>111111,222222,333333</param-value>
        </init-param>
    </servlet>

    <servlet-mapping>
        <servlet-name>LoginServlet</servlet-name>
        <url-pattern>/LoginServlet</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>LoginSuccess</servlet-name>
        <servlet-class>shopping.LoginSuccess</servlet-class>
    </servlet>

    <servlet-mapping>
        <servlet-name>LoginSuccess</servlet-name>
        <url-pattern>/LoginSuccess</url-pattern>
    </servlet-mapping>

</web-app>
